"use strict";(self.webpackChunkonboard_notify_react=self.webpackChunkonboard_notify_react||[]).push([[7844],{27844:function(n,e,t){t.r(e),t.d(e,{OpenloginAdapter:function(){return S},getOpenloginDefaultOptions:function(){return C}});var i=t(27329),r=t(46622),o=t(53755),a=t(47061),s=t(59900),c=t(14771),l=t(12731),u=t(24269),h=t(24593),p=t(70886),g=t(20240),f=t(88047),d=t.n(f),E=t(5275),v=t(46331),A=t.n(v),C=function(n,e){return{adapterSettings:{network:i.dr.MAINNET,clientId:"",uxMode:i.$e.POPUP},chainConfig:n?(0,r.getChainConfig)(n,e):null,loginSettings:{}}};function T(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(n);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),t.push.apply(t,i)}return t}function N(n){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{};e%2?T(Object(t),!0).forEach((function(e){(0,g.Z)(n,e,t[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):T(Object(t)).forEach((function(e){Object.defineProperty(n,e,Object.getOwnPropertyDescriptor(t,e))}))}return n}function P(n){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(n){return!1}}();return function(){var t,i=(0,p.Z)(n);if(e){var r=(0,p.Z)(this).constructor;t=Reflect.construct(i,arguments,r)}else t=i.apply(this,arguments);return(0,h.Z)(this,t)}}var S=function(n){(0,u.Z)(h,n);var e=P(h);function h(n){var t,o,s,l,u;(0,a.Z)(this,h),u=e.call(this),(0,g.Z)((0,c.Z)(u),"name",r.WALLET_ADAPTERS.OPENLOGIN),(0,g.Z)((0,c.Z)(u),"adapterNamespace",r.ADAPTER_NAMESPACES.MULTICHAIN),(0,g.Z)((0,c.Z)(u),"type",r.ADAPTER_CATEGORY.IN_APP),(0,g.Z)((0,c.Z)(u),"openloginInstance",null),(0,g.Z)((0,c.Z)(u),"clientId",void 0),(0,g.Z)((0,c.Z)(u),"status",r.ADAPTER_STATUS.NOT_READY),(0,g.Z)((0,c.Z)(u),"currentChainNamespace",r.CHAIN_NAMESPACES.EIP155),(0,g.Z)((0,c.Z)(u),"openloginOptions",void 0),(0,g.Z)((0,c.Z)(u),"loginSettings",{}),(0,g.Z)((0,c.Z)(u),"privKeyProvider",null),r.log.debug("const openlogin adapter",n);var p=C(null===(t=n.chainConfig)||void 0===t?void 0:t.chainNamespace,null===(o=n.chainConfig)||void 0===o?void 0:o.chainId);if(u.openloginOptions=N(N({clientId:"",network:i.dr.MAINNET},p.adapterSettings),n.adapterSettings||{}),u.clientId=null===(s=n.adapterSettings)||void 0===s?void 0:s.clientId,u.loginSettings=N(N({},p.loginSettings),n.loginSettings),u.sessionTime=u.loginSettings.sessionTime||86400,null!==(l=n.chainConfig)&&void 0!==l&&l.chainNamespace){var f;u.currentChainNamespace=null===(f=n.chainConfig)||void 0===f?void 0:f.chainNamespace;var d=p.chainConfig?p.chainConfig:{};if(u.chainConfig=N(N({},d),null===n||void 0===n?void 0:n.chainConfig),r.log.debug("const openlogin chainConfig",u.chainConfig),!u.chainConfig.rpcTarget&&n.chainConfig.chainNamespace!==r.CHAIN_NAMESPACES.OTHER)throw r.WalletInitializationError.invalidParams("rpcTarget is required in chainConfig")}return u}return(0,s.Z)(h,[{key:"chainConfigProxy",get:function(){return this.chainConfig?N({},this.chainConfig):null}},{key:"provider",get:function(){var n;return(null===(n=this.privKeyProvider)||void 0===n?void 0:n.provider)||null},set:function(n){throw new Error("Not implemented")}},{key:"init",value:function(){var n=(0,o.Z)(d().mark((function n(e){var t,o,a;return d().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if((0,l.Z)((0,p.Z)(h.prototype),"checkInitializationRequirements",this).call(this),null!==(t=this.openloginOptions)&&void 0!==t&&t.clientId){n.next=3;break}throw r.WalletInitializationError.invalidParams("clientId is required before openlogin's initialization");case 3:if(this.chainConfig){n.next=5;break}throw r.WalletInitializationError.invalidParams("chainConfig is required before initialization");case 5:return o=!1,this.openloginOptions.uxMode===i.$e.REDIRECT&&(a=(0,i.Gv)(),Object.keys(a).length>0&&a._pid&&(o=!0)),this.openloginOptions=N(N({},this.openloginOptions),{},{replaceUrlOnRedirect:o}),this.openloginInstance=new i.ZP(this.openloginOptions),r.log.debug("initializing openlogin adapter init"),n.next=12,this.openloginInstance.init();case 12:if(this.status=r.ADAPTER_STATUS.READY,this.emit(r.ADAPTER_EVENTS.READY,r.WALLET_ADAPTERS.OPENLOGIN),n.prev=14,r.log.debug("initializing openlogin adapter"),!this.openloginInstance.privKey||!e.autoConnect&&!o){n.next=19;break}return n.next=19,this.connect();case 19:n.next=25;break;case 21:n.prev=21,n.t0=n.catch(14),r.log.error("Failed to connect with cached openlogin provider",n.t0),this.emit("ERRORED",n.t0);case 25:case"end":return n.stop()}}),n,this,[[14,21]])})));return function(e){return n.apply(this,arguments)}}()},{key:"connect",value:function(){var n=(0,o.Z)(d().mark((function n(e){return d().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return(0,l.Z)((0,p.Z)(h.prototype),"checkConnectionRequirements",this).call(this),this.status=r.ADAPTER_STATUS.CONNECTING,this.emit(r.ADAPTER_EVENTS.CONNECTING,N(N({},e),{},{adapter:r.WALLET_ADAPTERS.OPENLOGIN})),n.prev=3,n.next=6,this.connectWithProvider(e);case 6:return n.abrupt("return",this.provider);case 9:if(n.prev=9,n.t0=n.catch(3),r.log.error("Failed to connect with openlogin provider",n.t0),this.status=r.ADAPTER_STATUS.READY,this.emit(r.ADAPTER_EVENTS.ERRORED,n.t0),null===n.t0||void 0===n.t0||!n.t0.message.includes("user closed popup")){n.next=16;break}throw r.WalletLoginError.popupClosed();case 16:throw r.WalletLoginError.connectionError("Failed to login with openlogin");case 17:case"end":return n.stop()}}),n,this,[[3,9]])})));return function(e){return n.apply(this,arguments)}}()},{key:"disconnect",value:function(){var n=(0,o.Z)(d().mark((function n(){var e,t=arguments;return d().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(e=t.length>0&&void 0!==t[0]?t[0]:{cleanup:!1},this.status===r.ADAPTER_STATUS.CONNECTED){n.next=3;break}throw r.WalletLoginError.notConnectedError("Not connected with wallet");case 3:if(this.openloginInstance){n.next=5;break}throw r.WalletInitializationError.notReady("openloginInstance is not ready");case 5:return n.next=7,this.openloginInstance.logout();case 7:e.cleanup?(this.status=r.ADAPTER_STATUS.NOT_READY,this.openloginInstance=null,this.privKeyProvider=null):this.status=r.ADAPTER_STATUS.READY,this.emit(r.ADAPTER_EVENTS.DISCONNECTED);case 9:case"end":return n.stop()}}),n,this)})));return function(){return n.apply(this,arguments)}}()},{key:"authenticateUser",value:function(){var n=(0,o.Z)(d().mark((function n(){var e;return d().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(this.status===r.ADAPTER_STATUS.CONNECTED){n.next=2;break}throw r.WalletLoginError.notConnectedError("Not connected with wallet, Please login/connect first");case 2:return n.next=4,this.getUserInfo();case 4:return e=n.sent,n.abrupt("return",{idToken:e.idToken});case 6:case"end":return n.stop()}}),n,this)})));return function(){return n.apply(this,arguments)}}()},{key:"getUserInfo",value:function(){var n=(0,o.Z)(d().mark((function n(){var e;return d().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(this.status===r.ADAPTER_STATUS.CONNECTED){n.next=2;break}throw r.WalletLoginError.notConnectedError("Not connected with wallet");case 2:if(this.openloginInstance){n.next=4;break}throw r.WalletInitializationError.notReady("openloginInstance is not ready");case 4:return n.next=6,this.openloginInstance.getUserInfo();case 6:return e=n.sent,n.abrupt("return",e);case 8:case"end":return n.stop()}}),n,this)})));return function(){return n.apply(this,arguments)}}()},{key:"setAdapterSettings",value:function(n){if(this.status!==r.ADAPTER_STATUS.READY){var e=C();this.openloginOptions=N(N(N({},e.adapterSettings),this.openloginOptions||{}),n),n.sessionTime&&(this.loginSettings=N(N({},this.loginSettings),{},{sessionTime:n.sessionTime})),n.clientId&&(this.clientId=n.clientId)}}},{key:"setChainConfig",value:function(n){(0,l.Z)((0,p.Z)(h.prototype),"setChainConfig",this).call(this,n),this.currentChainNamespace=n.chainNamespace}},{key:"connectWithProvider",value:function(){var n=(0,o.Z)(d().mark((function n(){var e,o,a,s,c,l,u,h,p,g=arguments;return d().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(e=g.length>0&&void 0!==g[0]?g[0]:{},this.chainConfig){n.next=3;break}throw r.WalletInitializationError.invalidParams("chainConfig is required before initialization");case 3:if(this.openloginInstance){n.next=5;break}throw r.WalletInitializationError.notReady("openloginInstance is not ready");case 5:if(this.currentChainNamespace!==r.CHAIN_NAMESPACES.SOLANA){n.next=13;break}return n.next=8,Promise.all([t.e(9130),t.e(4607),t.e(4558)]).then(t.bind(t,74607));case 8:o=n.sent,a=o.SolanaPrivateKeyProvider,this.privKeyProvider=new a({config:{chainConfig:this.chainConfig}}),n.next=26;break;case 13:if(this.currentChainNamespace!==r.CHAIN_NAMESPACES.EIP155){n.next=21;break}return n.next=16,Promise.all([t.e(7174),t.e(4992),t.e(7983),t.e(1587),t.e(2132),t.e(2080)]).then(t.bind(t,2132));case 16:s=n.sent,c=s.EthereumPrivateKeyProvider,this.privKeyProvider=new c({config:{chainConfig:this.chainConfig}}),n.next=26;break;case 21:if(this.currentChainNamespace!==r.CHAIN_NAMESPACES.OTHER){n.next=25;break}this.privKeyProvider=new E.FL,n.next=26;break;case 25:throw new Error("Invalid chainNamespace: ".concat(this.currentChainNamespace," found while connecting to wallet"));case 26:if(this.openloginInstance.privKey){n.next=30;break}return this.loginSettings.curve||(this.loginSettings.curve=this.currentChainNamespace===r.CHAIN_NAMESPACES.SOLANA?i.x7.ED25519:i.x7.SECP256K1),n.next=30,this.openloginInstance.login(A()(this.loginSettings,e,{loginProvider:e.loginProvider},{extraLoginOptions:N(N({},e.extraLoginOptions||{}),{},{login_hint:e.login_hint||(null===(l=e.extraLoginOptions)||void 0===l?void 0:l.login_hint)})}));case 30:if(!(u=this.openloginInstance.privKey)){n.next=42;break}if(this.currentChainNamespace!==r.CHAIN_NAMESPACES.SOLANA){n.next=38;break}return n.next=35,Promise.all([t.e(9130),t.e(7950)]).then(t.bind(t,66017));case 35:h=n.sent,p=h.getED25519Key,u=p(u).sk.toString("hex");case 38:return n.next=40,this.privKeyProvider.setupProvider(u);case 40:this.status=r.ADAPTER_STATUS.CONNECTED,this.emit(r.ADAPTER_EVENTS.CONNECTED,{adapter:r.WALLET_ADAPTERS.OPENLOGIN,reconnected:!e});case 42:case"end":return n.stop()}}),n,this)})));return function(){return n.apply(this,arguments)}}()}]),h}(r.BaseAdapter)}}]);
//# sourceMappingURL=7844.62c059c2.chunk.js.map